var playerSprite,pipesSprites,backgroundSprite,bird,pipes,lastTime,nowTime,dt,fpm,sfx_die,sfx_hit,sfx_point,sfx_wing,gravity=.3,flap=-6,speed=2,score=0,highScore=0,speedUp=0,SCENE_MAIN=1,SCENE_DEATH=2,currentScene=SCENE_MAIN;function loadingSucess(){}function loadingError(e){Swal.fire({icon:"error",title:"Error",text:"An error occured while loading the image. Please refresh this page or try again later."})}function preload(){bird=new Bird,pipes=[new Pipe,new Pipe,new Pipe];for(var e=0,i=0;i<pipes.length;i++)pipes[i].x=e+350,e+=200;playerSprite=new JSAnimatedSprite("img/bird.png",4,5,16,16),pipesSprites=new JSSpriteSheet("img/pipes.png"),backgroundSprite=new JSSprite("img/background.png",0,0,256,256),playerSprite.loadP5Image(loadingSucess,loadingError),pipesSprites.loadP5Image(loadingSucess,loadingError),backgroundSprite.loadP5Image(loadingSucess,loadingError),sfx_die=new Howl({src:["sfx/die.wav"]}),sfx_hit=new Howl({src:["sfx/hit.wav"]}),sfx_point=new Howl({src:["sfx/point.wav"]}),sfx_wing=new Howl({src:["sfx/wing.wav"]})}function setup(){createCanvas(300,400).parent("canvas"),noSmooth(),lastTime=(new Date).getTime()}function draw(){switch(currentScene){case SCENE_DEATH:death();break;case SCENE_MAIN:mainGame()}}function death(){speed=0,clear(),backgroundSprite.drawP5Image(0,0,300,400),pipes[0].draw(pipesSprites),pipes[1].draw(pipesSprites),pipes[2].draw(pipesSprites),bird.draw(playerSprite),bird.update(dt),pipes[0].update(bird,dt),pipes[1].update(bird,dt),pipes[2].update(bird,dt),400<=bird.y&&(sfx_die.play(),currentScene=SCENE_MAIN,restartGame())}function mainGame(){var e,i;fpm=frameRate()/1e3,nowTime=(new Date).getTime(),dt=nowTime-lastTime,dt*=fpm,lastTime=nowTime,clear(),backgroundSprite.drawP5Image(0,0,300,400),bird.draw(playerSprite),pipes[0].draw(pipesSprites),pipes[1].draw(pipesSprites),e=pipes[2].draw(pipesSprites),bird.update(dt),i=pipes[0].update(bird,dt),pipes[1].update(bird,dt),pipes[2].update(bird,dt),i&&(i=pipes[0],pipes[0]=pipes[1],pipes[1]=pipes[2],pipes[2]=i,pipes[2].x=e+200,pipes[2].height=Math.floor(151*Math.random()+50),pipes[2].scored=!1),10===speedUp&&(speedUp=0,speed+=.5),fill(0),textSize(15),text("Score : "+score,5,20),text("High score : "+highScore,5,35),text("Speed : "+speed,5,50)}function keyTyped(){if(!bird.gameOver)return" "===key&&(bird.dy=flap,sfx_wing.play()),!1}function mousePressed(){if(!bird.gameOver)return bird.dy=flap,sfx_wing.play(),!1}function touchStarted(){if(!bird.gameOver)return bird.dy=flap,sfx_wing.play(),!1}function restartGame(){sfx_hit.stop(),highScore=highScore<score?score:highScore,speed=2,speedUp=score=0,bird=new Bird,pipes=[new Pipe,new Pipe,new Pipe];for(var e=0,i=0;i<pipes.length;i++)pipes[i].x=e+350,e+=200}p5.disableFriendlyErrors=!0;