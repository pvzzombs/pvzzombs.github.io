var player,platforms,platformTest,ground,playerSpriteIdleLeft,playerSpriteRunLeft,playerSpriteIdleRight,playerSpriteRunRight,platformSprite,worldSprite,gui,leftBtn,rightBtn,jumpBtn,fullScreenBtn,centerViewBtn,leftKeyPressed=!1,rightKeyPressed=!1,centerCamera=!1,platformsCount=10;function toggleFullscreen(){console.log("Toggle fullscreen");var e=document.getElementById("canvas");document.fullscreenElement?document.exitFullscreen().catch(function(e){console.log(e)}):(e.requestFullscreen().catch(function(e){console.log(e)}),screen.orientation.lock("landscape"))}function loadingText(){var e=document.getElementById("loadingText");e&&(e.innerText="Loaded "+ ++currentImageLoadedLength+"/"+imagesLength),currentImageLoadedLength===imagesLength&&(e.style.display="none",shouldDisplay=!0)}function loadingError(e){Swal.fire({icon:"error",title:"Error",text:"An error occured while loading the image. Please refresh this page or try again later."})}function preload(){playerSpriteIdleLeft=new JSAnimatedSprite("img/idleLeft.png",4,5,15,21),playerSpriteIdleRight=new JSAnimatedSprite("img/idleRight.png",4,5,15,21),playerSpriteRunLeft=new JSAnimatedSprite("img/runLeft.png",4,5,16,20),playerSpriteRunRight=new JSAnimatedSprite("img/runRight.png",4,5,16,20),platformSprite=new JSSprite("img/platforms.png",0,0,16,16),worldSprite=new JSSpriteSheet("img/world_tileset.png"),playerSpriteIdleLeft.loadP5Image(),playerSpriteIdleRight.loadP5Image(),playerSpriteRunLeft.loadP5Image(),playerSpriteRunRight.loadP5Image(),platformSprite.loadP5Image(),worldSprite.loadP5Image()}function setup(){createCanvas(640,360).parent("canvas"),noSmooth(),player=new Player,ground=new Ground,platforms=[];for(var e=0,r=340,t=0;t<platformsCount;t++)platforms.push(new Platform),platforms[t].x=e,platforms[t].y=r,e+=100,r-=40;player.currentSprite=playerSpriteIdleRight,gui=createGui(),leftBtn=createButton("A",10,240,50,50),rightBtn=createButton("D",80,240,50,50),jumpBtn=createButton(" ",580,240,50,50),fullScreenBtn=createButton("F",10,10,50,50),centerViewBtn=createButton("C",580,10,50,50)}function draw(){mainGame()}function mainGame(){background(128),360<=player.y+player.height+player.dy?(player.dy=0,player.y=360-player.hitbox.height-player.hitbox.y,player.canJump=!0):(player.dy+=player.gravity,player.canJump=!1),player.dx=0,leftKeyPressed?player.dx=-4:rightKeyPressed&&(player.dx=4);for(var e=0;e<platformsCount;e++)platforms[e].update();if(player.update(),centerCamera){for(var r=320-(player.x+player.hitbox.x+player.hitbox.width/2),t=180-(player.y+player.hitbox.y+player.hitbox.height/2),e=0;e<platformsCount;e++)platforms[e].drawDelta(r,t);player.drawDelta(r,t),ground.drawDelta(r,t)}else{for(e=0;e<platformsCount;e++)platforms[e].draw();player.draw()}leftBtn.isPressed?(rightKeyPressed=!(leftKeyPressed=!0),player.currentSprite=playerSpriteRunLeft):rightBtn.isPressed&&(leftKeyPressed=!(rightKeyPressed=!0),player.currentSprite=playerSpriteRunRight),fullScreenBtn.isPressed&&toggleFullscreen(),jumpBtn.isPressed&&player.canJump&&(player.dy=-15,player.canJump=!1),centerViewBtn.isPressed&&(centerCamera=!centerCamera),leftBtn.isReleased?(leftKeyPressed=!1,player.currentSprite=playerSpriteIdleLeft):rightBtn.isReleased&&(rightKeyPressed=!1,player.currentSprite=playerSpriteIdleRight),drawGui()}function mousePressed(){}function touchStarted(){}function touchEnded(){}function keyPressed(){switch(key){case" ":player.canJump&&(player.dy=-15,player.canJump=!1);break;case"s":case"S":player.dy+=player.gravity;break;case"a":case"A":rightKeyPressed=!(leftKeyPressed=!0),player.currentSprite=playerSpriteRunLeft;break;case"d":case"D":leftKeyPressed=!(rightKeyPressed=!0),player.currentSprite=playerSpriteRunRight;break;case"c":case"C":centerCamera=!centerCamera}player.update(),player.draw()}function keyReleased(){switch(key){case"a":case"A":leftKeyPressed=!1,player.currentSprite=playerSpriteIdleLeft;break;case"d":case"D":rightKeyPressed=!1,player.currentSprite=playerSpriteIdleRight}player.update(),player.draw()}window.onload=function(){document.getElementById("full").onclick=toggleFullscreen},p5.disableFriendlyErrors=!0;