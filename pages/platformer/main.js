var player,platforms,platformTest,ground,details,playerSpriteIdleLeft,playerSpriteRunLeft,playerSpriteIdleRight,playerSpriteRunRight,platformSprite,worldSprite,leftBtnSprite,rightBtnSprite,jumpBtnSprite,fullScreenBtnSprite,centerViewBtnSprite,exitFullscreenSprite,leftBtn,rightBtn,jumpBtn,fullScreenBtn,centerViewBtn,leftKeyPressed=!1,rightKeyPressed=!1,centerCamera=!0,platformsCount=10,worldWidth=640,worldHeight=360,isMobile=!1;function toggleFullscreen(){console.log("Toggle fullscreen");var e=document.getElementById("canvas");document.fullscreenElement?(document.exitFullscreen().catch(function(e){console.log(e)}),fullScreenBtn.label=fullScreenBtnSprite):(e.requestFullscreen().catch(function(e){console.log(e)}),screen.orientation.lock("landscape"),fullScreenBtn.label=exitFullscreenSprite)}function loadingText(){var e=document.getElementById("loadingText");e&&(e.innerText="Loaded "+ ++currentImageLoadedLength+"/"+imagesLength),currentImageLoadedLength===imagesLength&&(e.style.display="none",shouldDisplay=!0)}function loadingError(e){Swal.fire({icon:"error",title:"Error",text:"An error occured while loading the image. Please refresh this page or try again later."})}function preload(){playerSpriteIdleLeft=new JSAnimatedSprite("img/idleLeft.png",4,5,15,21),playerSpriteIdleRight=new JSAnimatedSprite("img/idleRight.png",4,5,15,21),playerSpriteRunLeft=new JSAnimatedSprite("img/runLeft.png",4,5,16,20),playerSpriteRunRight=new JSAnimatedSprite("img/runRight.png",4,5,16,20),platformSprite=new JSSprite("img/platforms.png",0,0,16,16),worldSprite=new JSSpriteSheet("img/world_tileset.png"),playerSpriteIdleLeft.loadP5Image(),playerSpriteIdleRight.loadP5Image(),playerSpriteRunLeft.loadP5Image(),playerSpriteRunRight.loadP5Image(),platformSprite.loadP5Image(),worldSprite.loadP5Image(),leftBtnSprite=new JSSprite("img/backward.png",0,0,50,50),rightBtnSprite=new JSSprite("img/forward.png",0,0,50,50),jumpBtnSprite=new JSSprite("img/up.png",0,0,50,50),fullScreenBtnSprite=new JSSprite("img/larger.png",0,0,50,50),centerViewBtnSprite=new JSSprite("img/gear.png",0,0,50,50),exitFullscreenSprite=new JSSprite("img/smaller.png",0,0,50,50),leftBtnSprite.loadP5Image(),rightBtnSprite.loadP5Image(),jumpBtnSprite.loadP5Image(),fullScreenBtnSprite.loadP5Image(),centerViewBtnSprite.loadP5Image(),exitFullscreenSprite.loadP5Image()}function setup(){createCanvas(worldWidth,worldHeight).parent("canvas"),noSmooth(),randomSeed(100),player=new Player,ground=new Ground,details=new Details,platforms=[];for(var e=0,t=340,r=0;r<platformsCount;r++)platforms.push(new Platform),platforms[r].x=e,platforms[r].y=t,e+=100,t-=20;player.currentSprite=playerSpriteIdleRight,leftBtn=new Button(leftBtnSprite,10,240,50,50),rightBtn=new Button(rightBtnSprite,80,240,50,50),jumpBtn=new Button(jumpBtnSprite,580,240,50,50),fullScreenBtn=new Button(fullScreenBtnSprite,10,10,50,50),centerViewBtn=new Button(centerViewBtnSprite,580,10,50,50)}function draw(){mainGame()}function mainGame(){background(128),player.y+player.height+player.dy>=worldHeight?(player.dy=0,player.y=worldHeight-player.hitbox.height-player.hitbox.y,player.canJump=!0):(player.dy+=player.gravity,player.canJump=!1),player.dx=0,leftKeyPressed?player.dx=-4:rightKeyPressed&&(player.dx=4);for(var e=0;e<platformsCount;e++)platforms[e].update();if(player.update(),centerCamera){for(var t=worldWidth/2-(player.x+player.hitbox.x+player.hitbox.width/2),r=worldHeight/2-(player.y+player.hitbox.y+player.hitbox.height/2),e=0;e<platformsCount;e++)platforms[e].drawDelta(t,r);player.drawDelta(t,r),ground.drawDelta(t,r),details.drawDelta(t,r)}else{for(e=0;e<platformsCount;e++)platforms[e].draw();player.draw()}isMobile&&(leftBtn.draw(),rightBtn.draw(),jumpBtn.draw(),fullScreenBtn.draw(),centerViewBtn.draw())}function mousePressed(){}function touchStarted(){!leftBtn.active&&leftBtn.isTouchOver()?(leftBtn.active=!0,rightKeyPressed=!(leftKeyPressed=!0),player.currentSprite=playerSpriteRunLeft):!rightBtn.active&&rightBtn.isTouchOver()&&(rightBtn.active=!0,leftKeyPressed=!(rightKeyPressed=!0),player.currentSprite=playerSpriteRunRight),!jumpBtn.active&&jumpBtn.isTouchOver()&&(jumpBtn.active=!0,player.canJump)&&(player.dy=-15,player.canJump=!1),!fullScreenBtn.active&&fullScreenBtn.isTouchOver()&&(fullScreenBtn.active=!0,toggleFullscreen()),!centerViewBtn.active&&centerViewBtn.isTouchOver()&&(centerViewBtn.active=!0,centerCamera=!centerCamera)}function touchEnded(){leftBtn.active&&!leftBtn.isTouchOver()?(leftBtn.active=!1,leftKeyPressed=!1,player.currentSprite=playerSpriteIdleLeft):rightBtn.active&&!rightBtn.isTouchOver()&&(rightBtn.active=!1,rightKeyPressed=!1,player.currentSprite=playerSpriteIdleRight),jumpBtn.active&&!jumpBtn.isTouchOver()&&(jumpBtn.active=!1),fullScreenBtn.active&&!fullScreenBtn.isTouchOver()&&(fullScreenBtn.active=!1),centerViewBtn.active&&!centerViewBtn.isTouchOver()&&(centerViewBtn.active=!1)}function keyPressed(){switch(key){case" ":player.canJump&&(player.dy=-15,player.canJump=!1);break;case"s":case"S":player.dy+=player.gravity;break;case"a":case"A":if(rightKeyPressed)return;leftKeyPressed=!0,player.currentSprite=playerSpriteRunLeft;break;case"d":case"D":if(leftKeyPressed)return;rightKeyPressed=!0,player.currentSprite=playerSpriteRunRight;break;case"c":case"C":centerCamera=!centerCamera}player.update(),player.draw()}function keyReleased(){switch(key){case"a":case"A":if(rightKeyPressed)return;leftKeyPressed=!1,player.currentSprite=playerSpriteIdleLeft;break;case"d":case"D":if(leftKeyPressed)return;rightKeyPressed=!1,player.currentSprite=playerSpriteIdleRight}player.update(),player.draw()}(void 0!==window.ontouchstart||0<navigator.maxTouchPoints)&&(isMobile=!0),window.onload=function(){document.getElementById("full").onclick=toggleFullscreen},p5.disableFriendlyErrors=!0;