var canvasWidth,canvasHeight,canvasContext,rect,zoomOnClick=!0,useInterval=!0,flipImaginaryAxis=1,pixelSizes=[8,5,1],mandelbrotCalls=new Array(pixelSizes.length),drawColumnIDs=new Array(pixelSizes.length),canvas=document.getElementById("paper"),canvasWrapper=document.getElementById("canvasWrapper");function drawOnClick(e){rect=canvas.getBoundingClientRect();var a,n,t=e.clientX-rect.left,o=e.clientY-rect.top;panY=(panX=(zoomOnClick?(a=panX+t/zooms,n=panY+flipImaginaryAxis*(o/zooms),zooms*=zf):(a=panX+t/zooms,n=panY+flipImaginaryAxis*(o/zooms),zooms/=zf),a-(e.clientX-rect.left)/zooms),n-flipImaginaryAxis*((e.clientY-rect.top)/zooms)),pan=panX+2/zooms-(panX-1/zooms),document.getElementById("xa").value=panX,document.getElementById("ya").value=panY,document.getElementById("za").value=zooms,pallete.setNumberRange(0,maxI),show(),abortRun(),startRun()}function plus(){zoomOnClick=!0}function minus(){zoomOnClick=!1}function abortRun(){for(var e=0;e<mandelbrotCalls.length;e++)clearTimeout(mandelbrotCalls[e]);if(useInterval)for(e=0;e<drawColumnIDs.length;e++)clearInterval(drawColumnIDs[e]);else for(e=0;e<drawColumnIDs.length;e++)cancelAnimationFrame(drawColumnIDs[e])}function startRun(){for(var e=0;e<pixelSizes.length;e++)mandelbrotCalls[e]=setTimeout(function(e){return function(){mandelbrot(zooms,panX,panY,pixelSizes[e],e)}}(e))}canvas.width=canvasWrapper.clientWidth,canvas.height=canvasWrapper.clientWidth,canvasContext=canvas.getContext("2d"),canvasWidth=canvas.width,canvasHeight=canvas.height,canvas.onclick=function(e){drawOnClick(e)};var pan,zooms,panX,panY,zf,ticks,coloringType,maxI=50,pallete=new Rainbow,_pallete=(pallete.setSpectrum("#000764","#206bcb","#edffff","#ffaa00","#000200"),pallete.setNumberRange(0,maxI),["#000764","#206bcb","#edffff","#ffaa00","#000200"]);function mdbl(e,a,n,t,o,l,r,m,s){for(a=0;a<canvasHeight;a+=m){x0=l+e/o,y0=r+flipImaginaryAxis*(a/o);for(var c,n=0,t=0,i=0;n*n+t*t<=4&&i<maxI;)c=n*n-t*t+x0,t=2*n*t+y0,n=c,i+=1;s(e,a,n,t,i,m)}}function mandelbrot(a,n,t,o,l){var r,m,s,c;o=o||1,r=0,drawColumnIDs[l]=useInterval?setInterval(function(){r<canvasWidth?(mdbl(r,m,s,c,a,n,t,o,coloringMethod),r+=o):clearInterval(drawColumnIDs[l])}):requestAnimationFrame(function e(){r<canvasWidth?(mdbl(r,m,s,c,a,n,t,o,coloringMethod),r+=o,drawColumnIDs[l]=requestAnimationFrame(e)):cancelAnimationFrame(drawColumnIDs[l])})}function coloringMethod(e,a,n,t,o,l){"smoothColoring"===coloringType?o<maxI?(log_zn=Math.log(n*n+t*t)/2,o=o+1-(nu=Math.log(log_zn/Math.log(2))/Math.log(2)),canvasContext.fillStyle=color(o/maxI*(_pallete.length-1))):canvasContext.fillStyle="black":canvasContext.fillStyle=color(o),canvasContext.fillRect(e,a,l,l)}function color(e){switch(coloringType){case"escapeTime":return"#"+pallete.colourAt(e);case"smoothColoring":return interpolation(e);default:return"#"+pallete.colourAt(e)}}function hexToRGBObject(e){return e=(e+"").replace("#",""),{r:parseInt(e.charAt(0)+e.charAt(1),16),g:parseInt(e.charAt(2)+e.charAt(3),16),b:parseInt(e.charAt(4)+e.charAt(5),16)}}function linear_interpolate(e,a,n){return"rgb("+Math.floor((a.r-e.r)*n+e.r)+","+Math.floor((a.g-e.g)*n+e.g)+","+Math.floor((a.b-e.b)*n+e.b)+")"}function interpolation(e){return linear_interpolate(hexToRGBObject(_pallete[Math.floor(e)]),hexToRGBObject(_pallete[Math.floor(e)+1]),e%1)}function work(){pan=.1,zooms=canvasWidth/4,panX=-2.5,panY=-2*(flipImaginaryAxis=1),zf=1.5,maxI=50,pallete.setSpectrum("#000764","#206bcb","#edffff","#ffaa00","#000200"),pallete.setNumberRange(0,maxI),_pallete=["#000764","#206bcb","#edffff","#ffaa00","#000200"],coloringType="smoothColoring",document.getElementById(coloringType).checked=!0,document.getElementById("flipImaginaryAxis").checked=!0,document.getElementById("xa").value=panX,document.getElementById("ya").value=panY,document.getElementById("za").value=zooms,show(),abortRun(),startRun()}function resetCoordinates(){pan=.1,zooms=canvasWidth/4,panX=-2.5,panY=-2*flipImaginaryAxis,document.getElementById("xa").value=panX,document.getElementById("ya").value=panY,document.getElementById("za").value=zooms,show(),abortRun(),startRun()}function flipImagAxis(){flipImaginaryAxis=1==flipImaginaryAxis?-1:1,panY*=-1,document.getElementById("ya").value=panY,show(),abortRun(),startRun()}function xScroll(e){e=e?parseFloat(document.getElementById("xa").value)+pan:parseFloat(document.getElementById("xa").value)-pan;document.getElementById("xa").value=e,panX=e,show(),abortRun(),startRun()}function yScroll(e){e=e?parseFloat(document.getElementById("ya").value)+pan:parseFloat(document.getElementById("ya").value)-pan;document.getElementById("ya").value=e,panY=e,show(),abortRun(),startRun()}function drawAgain(){panX=parseFloat(document.getElementById("xa").value),panY=parseFloat(document.getElementById("ya").value),zooms=parseFloat(document.getElementById("za").value),show(),abortRun(),startRun()}function zoom(){zooms=document.getElementById("za").value,mx=(panX+(canvasWidth-1)/zooms-panX)/2,panX-=mx,my=(panY+(canvasHeight-1)/zooms-panY)/2,panY-=mx,show(),abortRun(),startRun()}function zoomIn(){pan=panX+2/(zooms+=zf)-(panX-1/zooms),document.getElementById("za").value=zooms,show(),abortRun(),startRun()}function zoomOut(){pan=panX+2/(zooms-=zf)-(panX-1/zooms),document.getElementById("za").value=zooms,show(),abortRun(),startRun()}function zoomFactor(){var e=document.getElementById("zf").value;zf=parseFloat(e),show()}function changeMaxI(){var e=document.getElementById("mi").value;maxI=parseInt(e),pallete.setNumberRange(0,maxI),show(),abortRun(),startRun()}function changeColoringType(e){e=e.value;coloringType=e,show(),abortRun(),startRun()}function changePallete(){var e=document.getElementById("plt").value.split(" ");e.length<3?alert(" Please enter more colors "):(pallete.setSpectrumByArray(e),show(),abortRun(),startRun())}function changeCoords(){var e=document.getElementById("crd").value.split(" ");e.length<4?alert(" Please enter complete details"):(panX=parseFloat(e[0]),panY=parseFloat(e[1]),zooms=parseFloat(e[2]),maxI=parseFloat(e[3]),zf=1.5,pan=panX+2/zooms-(panX-1/zooms),pallete.setNumberRange(0,maxI),document.getElementById("xa").value=panX,document.getElementById("ya").value=panY,document.getElementById("za").value=zooms,document.getElementById("mi").value=maxI,document.getElementById("zf").value=zf,show(),abortRun(),startRun())}function fullResize(){}function resize(){canvasWidth=canvas.width=parseInt(prompt("Please enter canvas width in pixels",200))||200,canvasHeight=canvas.height=parseInt(prompt("Please enter canvas height in pixels",200))||200,work()}function show(){var e="Scroll: "+pan+"<br /> Current zoom: "+zooms+"<br /> left: "+panX+"<br /> right: "+(panX+canvasWidth/zooms)+"<br /> top: "+panY+"<br /> bottom: "+(panY+flipImaginaryAxis*(canvasHeight/zooms))+"<br /> zoom factor: "+zf+"<br /> max iterations of loop: "+maxI+"<br /> uses "+coloringType+" algorithm for coloring";document.getElementById("dtls").innerHTML=e}function about(){Swal.fire({type:"info",title:"About",text:"A mandelbrot set generator in javascript created by pvzzombs. "})}work();